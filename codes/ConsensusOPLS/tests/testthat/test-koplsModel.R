test_that("koplsModel", {
    rvcopls <- RVConsensusOPLS(data=demo_3_Omics[c("MetaboData", "MicroData", "ProteoData")], 
                               Y=demo_3_Omics$Y)
    expect_equal(rvcopls$Model$Cp[,1], 
                 c(-0.707106781186547,
                   0.707106781186547))
    expect_equal(rvcopls$Model$Sp,
                 6.23590587941598)
    expect_equal(rvcopls$Model$Up,
                 c(rep(-0.761499610508589, 7), rep(0.652713951864505, 7)))
    expect_equal(rvcopls$Model$Tp,
                 c(-0.299320882028158,-0.234737503178361,-0.239561232530216,
                   -0.329485836706056,-0.247801779546492,-0.414865384358841,
                   0.201072327452167,0.245312729047383,0.232741457001741,
                   0.239571529778011,0.277280779035913,0.23723617065337,
                   0.332557625379539,-0.293162869190637,-0.275152737076048,
                   -0.295631263365155,-0.3005047448671,-0.302314707969838,
                   -0.299006295879345,0.240391760356673,0.252064460741037,
                   0.247904497175615,0.243334708084674,0.293420333759489,
                   0.246726860097512,0.241929998133122))
    expect_equal(rvcopls$Model$T,
                 c(-0.293162869190637,-0.275152737076048,-0.295631263365155,
                   -0.3005047448671,-0.302314707969838,-0.299006295879345,
                   0.240391760356673,0.252064460741037,0.247904497175615,
                   0.243334708084674,0.293420333759489,0.246726860097512,
                   0.241929998133122))
    expect_equal(rvcopls$Model$To,
                 c(-0.0341849943797184,0.224357204198932,0.311261723470934,
                   -0.160882818495652,0.302617776374132,-0.643168891168641,
                   -0.218274080993194,-0.0374809075737232,-0.0841746285368153,
                   -0.0208905425593303,-0.0895955565657284,-0.05268569161318,
                   0.503101407841982))
    expect_equal(rvcopls$Model$R2X,
                 c(0.18253923588794,0.257726827483885))
    expect_equal(rvcopls$Model$R2XO,
                 c(0,0.0811103596697501))
    expect_equal(rvcopls$Model$R2XC,
                 c(0.18253923588794,0.176616467814135))
    ##TODO K, etc.
})
